name: Run Parks Backfill (Balanced)

on:
  workflow_dispatch:

jobs:
  run-backfill-balanced:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Verify Firebase CLI version (v12.9.1)
        run: npx -y firebase-tools@12.9.1 --version

      - name: Call runParksBackfillOnce (balanced)
        env:
          FIREBASE_TOKEN: ${{ secrets.FIREBASE_DEPLOY_KEY }}
        run: |
          npx -y firebase-tools@12.9.1 \
            --project courthub-app \
            functions:call runParksBackfillOnce \
            --data '{"mode":"balanced","capPerRun":40000}'
